#set math.mat(delim: "[", gap: 0.8em, row-gap: 0.8em)
#set text(size: 13pt, font: "New Computer Modern Math")

=== B matrix from paper

#v(1em)

#block[
  #set text(size: 18pt)
  $B = mat(
    0.2816, -0.0052, -0.0406, -0.0305, -0.0316, -0.0505;
    -0.0112, 0.2553, -0.0423, -0.0666, -0.0756, -0.0346;
    -0.0470, -0.0332, 0.2795, -0.0064, -0.0237, -0.0530;
    -0.0308, -0.0646, -0.0129, 0.2348, -0.0833, -0.0193;
    -0.0411, -0.0661, -0.0217, -0.0760, 0.2537, -0.0118;
    -0.0477, -0.0208, -0.0402, -0.0250, -0.0056, 0.2302
  )$
]


#v(1em)

=== Amplifier gain matrix
#v(1em)

#block[
  #set text(size: 18pt)
$k_A = mat(
  0.3618, 0, 0, 0, 0, 0;
  0, 0.3614, 0, 0, 0, 0;
  0, 0, 0.3536, 0, 0, 0;
  0, 0, 0, 0.3532, 0, 0;
  0, 0, 0, 0, 0.3573, 0;
  0, 0, 0, 0, 0, 0.3610
)$
]

#pagebreak()

=== Excitation : 1 Hz , 2V
#v(1em)

#block[
  #set text(size: 16pt)
$|B| = mat(
  0.24658067, -0.00632653, -0.03360383, -0.03693433, -0.04377303, -0.03758178;
  -0.00382582, 0.30378633, -0.04427679, -0.07201857, -0.07833279, -0.04142051;
  -0.03879909, -0.03543384, 0.21901965, -0.00584744, -0.02633413, -0.03772986;
  -0.02718124, -0.0853105,  -0.00592537, 0.24953415, -0.07784175, -0.0247489;
  -0.04143301, -0.08095197, -0.02381626, -0.07517963, 0.25972779, -0.00510934;
  -0.02576626, -0.04007577, -0.02666458, -0.02938011, -0.00287754, 0.20256056;
)$
]

#v(3em)

$angle B = mat(
  -11.0929065,   171.37958849,  170.15605542,  164.16890612,  164.2913455,   170.40600012;
  178.88323324, -11.03143089,  167.95879458,  168.66897165,  169.1887177,   168.08660986;
  170.12246128,  164.06049162,  -11.41548471,  169.90626308,  163.98896919,  169.94117952;
  168.17439832,  169.01241655,  175.09208094,  -11.58580977,  168.91597365,  169.05146885;
  168.65296226,  169.29560318,  169.30510804,  168.61793995,  -11.20150327,  177.72878576;
  170.73405494,  165.21321701,  170.03201216,  164.3900047,   169.95760824,  -10.51943147;
)$

#v(1em)
=== Excitation : 10 Hz , 2V
#v(1em)

#block[
  #set text(size: 16pt)
  $|B| = mat(
  0.24473899, 0.00630781, 0.03361222, 0.0361936,  0.04289841, 0.03756457;
  0.00433558, 0.3023654,  0.04433865, 0.07116422, 0.07775933, 0.0414471;
  0.0387033,  0.03514576, 0.21811014, 0.00587409, 0.02621208, 0.0378427;
  0.0268988,  0.08488403, 0.006037,   0.24658481, 0.07744211, 0.0245942;
  0.04067364, 0.08058258, 0.02330298, 0.07423617, 0.25830651, 0.0052639;
  0.02586118, 0.03908048, 0.02677974, 0.02828104, 0.00287592, 0.20152426;
)$
]

#v(3em)

$angle B = mat(
  -13.85566535,  165.23607151,  169.25811048,  159.80591732,  159.79697418,  169.15989795;
  170.76281035, -14.54258525,  164.35552368,  164.67927196,  165.64108116,  163.87824959;
  168.96845388,  159.96627477,  -14.00811928,  162.56382526,  159.99134334,  168.32010519;
  165.07704402,  165.31556113,  178.85848934,  -15.34821974,  165.20295802,  166.16069013;
  164.66652664,  165.81282297,  166.8029658,   164.83186554,  -14.70657283,  176.91781302;
  170.20433477,  160.49438525,  169.03765805,  159.76726604,  157.06255937,  -13.3885864;
)$


#pagebreak()



=== Excitation : 10 Hz , 1V

#v(1em)


#block[
  #set text(size: 16pt)
$|B| = mat(
    0.20517077, 0.00462251, 0.03089278, 0.02320509, 0.0306122, 0.03348252;
    0.00225417, 0.19363567, 0.03076385, 0.03879625, 0.06119516, 0.01967132;
    0.0351563, 0.02359303, 0.17968416, 0.0041388, 0.01711158, 0.03376356;
    0.02423946, 0.05740677, 0.00524877, 0.18430113, 0.06878141, 0.01357055;
    0.03288766, 0.06835307, 0.01852937, 0.06166438, 0.21389108, 0.00489316;
    0.02408791, 0.01965349, 0.02336306, 0.01477262, 0.00152933, 0.14840225
)$
]

#block[
  #set text(size: 16pt)

]

#pagebreak()

=== KI matrix for measurement inverse model
#v(1em)
#block[
  #set text(size: 12pt)
$
  "KImeasInv" = mat(
  1.34390728, -0.39583777, -0.31621157, -0.16403375, -0.13345366, -0.33437054;
  -0.28336617, 0.80189302, -0.03033083, -0.23060068, -0.24647795, -0.01111738;
  -0.29251396, -0.14001728, 1.26687237, -0.37959149, -0.16924645, -0.28550319;
  -0.03744782, -0.22493618, -0.27927585, 0.82230575, -0.22839872, -0.05224718;
  0.00585624, -0.24470864, -0.06371571, -0.23125485, 0.82503219, -0.29120923;
  -0.32533638, -0.12923645, -0.29452210, -0.16636538, -0.39556121, 1.31102152
)
$
]
#v(1em)
=== KI matrix for modified inverse model
#v(1em)
#block[
  #set text(size: 12pt)
$
  "KImdfyInv" = mat(
  1.09028407, -0.32768104, -0.29314830, -0.09587702, -0.06529693, -0.30828078;
  -0.28499664, 0.83270594, -0.07413386, -0.19978776, -0.21566503, -0.05812265;
  -0.27200788, -0.07350130, 1.02748073, -0.31307551, -0.10273048, -0.26616557;
  -0.08064116, -0.19599993, -0.28216451, 0.85124201, -0.19946247, -0.09297395;
  -0.04496228, -0.21425886, -0.10293891, -0.20080507, 0.85548196, -0.29251684;
  -0.30072111, -0.06123104, -0.27504255, -0.09835997, -0.32755580, 1.06291047
)
$
]
#v(1em)
=== KI matrix for Hall sensor inverse model
#v(1em)
#block[
  #set text(size: 12pt)
$
  "KIhallInv" = mat(
  2.2523749, 0, 0, 0, 0, 0;
  0, 2.7488400, 0, 0, 0, 0;
  0, 0, 2.2456229, 0, 0, 0;
  0, 0, 0, 2.2936800, 0, 0;
  0, 0, 0, 0, 2.8320400, 0;
  0, 0, 0, 0, 0, 2.2947314
)
$
]
#pagebreak()

=== inv_B
#v(1em)
#block[
  #set text(size: 12pt)
$
"inv_B" = mat(
  1.254 times 10^3, 3.659 times 10^2, 3.627 times 10^2, 5.093 times 10^2, 5.107 times 10^2, 4.781 times 10^2;
  3.547 times 10^2, 1.162 times 10^3, 3.879 times 10^2, 6.699 times 10^2, 6.925 times 10^2, 4.486 times 10^2;
  4.275 times 10^2, 4.539 times 10^2, 1.259 times 10^3, 4.393 times 10^2, 4.880 times 10^2, 5.208 times 10^2;
  4.425 times 10^2, 6.546 times 10^2, 3.538 times 10^2, 1.461 times 10^3, 8.005 times 10^2, 4.488 times 10^2;
  4.142 times 10^2, 5.725 times 10^2, 3.374 times 10^2, 6.875 times 10^2, 1.274 times 10^3, 3.747 times 10^2;
  4.122 times 10^2, 4.009 times 10^2, 3.685 times 10^2, 4.744 times 10^2, 4.074 times 10^2, 1.372 times 10^3
) times "tune_L3"
$
]

=== tune_L3 = ThreeD_sine_theta

#pagebreak()

#block[
  #set text(size: 16pt)
$
"KI"_"theo" = mat(
  5/6, -1/6, -1/6, -1/6, -1/6, -1/6;
  -1/6, 5/6, -1/6, -1/6, -1/6, -1/6;
  -1/6, -1/6, 5/6, -1/6, -1/6, -1/6;
  -1/6, -1/6, -1/6, 5/6, -1/6, -1/6;
  -1/6, -1/6, -1/6, -1/6, 5/6, -1/6;
  -1/6, -1/6, -1/6, -1/6, -1/6, 5/6;
)
$
]

#v(2em)


== Calc_FNor_FromSixCurr_KItheo 
#v(1em)

=== Calc_Nxyz_KItheo ( N 矩陣)
#v(1em)
==== Calc_Pre_L ( L 矩陣參數)
==== Calc_Lx (X 方向 L 矩陣)
==== Calc_Ly (Y 方向 L 矩陣) 
==== Calc_Lz (Z 方向 L 矩陣)
==== CalcMat_6x6_6x6_6x6 (N = KItheo^T × L × KItheo)
#v(1em)

=== CalcMat_1x6_6x6_6x1 (I^T × N × I)


#pagebreak()

// B × k_A^(-1) 計算結果
$B times k_A^(-1) = mat(
   0.778331, -0.014388, -0.114819, -0.086353, -0.088441, -0.139889;
  -0.030956,  0.706419, -0.119627, -0.188562, -0.211587, -0.095845;
  -0.129906, -0.091865,  0.790441, -0.018120, -0.066331, -0.146814;
  -0.085130, -0.178749, -0.036482,  0.664779, -0.233137, -0.053463;
  -0.113599, -0.182900, -0.061369, -0.215176,  0.710048, -0.032687;
  -0.131841, -0.057554, -0.113688, -0.070781, -0.015673,  0.637673;
)$

#v(2em)
$B^(-1) = mat(
  4.537745, 1.262281, 1.304083, 1.702787, 1.660089, 1.713294;
  1.791069, 6.097167, 1.914850, 3.337411, 3.363285, 2.202419;
  1.502074, 1.536483, 4.476497, 1.455612, 1.580672, 1.794164;
  2.018073, 3.084840, 1.649475, 6.827655, 3.611612, 2.043706;
  2.010733, 2.917762, 1.654367, 3.395828, 6.372430, 1.871903;
  1.632493, 1.486789, 1.444353, 1.732688, 1.471162, 5.478867;
)$

#pagebreak()

#block[
  #set text(size: 14pt)
$B_"original"^(-1) = mat(
   4.514700,  1.185511,  1.279866,  1.660646,  1.617628,  1.685414;
   1.679753,  5.726351,  1.797874,  3.133857,  3.158185,  2.067752;
   1.474023,  1.443037,  4.447018,  1.404317,  1.528987,  1.760228;
   1.961753,  2.897227,  1.590291,  6.724668,  3.507843,  1.975572;
   1.957464,  2.740310,  1.598388,  3.298419,  6.274281,  1.807460;
   1.605349,  1.396366,  1.415829,  1.683051,  1.421149,  5.446029
)$

#v(2em)

$B^(-1) = mat(
   5.197682,  1.818962,  1.718694,  2.261508,  2.298680,  1.990719;
   1.490319,  5.527731,  2.033923,  3.049754,  3.063327,  2.235576;
   1.712324,  2.058866,  5.775286,  1.854326,  2.074037,  2.093308;
   1.896558,  3.350293,  1.807460,  6.626899,  3.524619,  2.272204;
   2.028865,  3.213460,  1.993750,  3.441743,  6.416958,  1.987263;
   1.485324,  2.127628,  1.671754,  2.145232,  1.773868,  6.265677
)$

#v(2em)

$
"inv_B"[0][0] &= 1254.43 \
"inv_B"[0][1] &= 365.92 \
"inv_B"[0][2] &= 362.72 \
"inv_B"[0][3] &= 509.35 \
"inv_B"[0][4] &= 510.70 \
"inv_B"[0][5] &= 478.06
$

#v(2em)
$B = mat(
  0.24658067, -0.00632653, -0.03360383, -0.03693433, -0.04377303, -0.03758178;
  -0.00382582, 0.30378633, -0.04427679, -0.07201857, -0.07833279, -0.04142051;
  -0.03879909, -0.03543384, 0.21901965, -0.00584744, -0.02633413, -0.03772986;
  -0.02718124, -0.0853105,  -0.00592537, 0.24953415, -0.07784175, -0.0247489;
  -0.04143301, -0.08095197, -0.02381626, -0.07517963, 0.25972779, -0.00510934;
  -0.02576626, -0.04007577, -0.02666458, -0.02938011, -0.00287754, 0.20256056;
)$
]

#pagebreak()

#v(1em)

==== Paper 1
#v(1em)

#block[
  #set text(size: 14pt)
  #set math.mat(delim: "[", gap: 0.5em, row-gap: 0.6em)
  $(B_1/(1-a_1+a_2)) = mat(
    0.26023, -0.00576, -0.03495, -0.03918, -0.04724, -0.04983;
    -0.00716, 0.34710, -0.04209, -0.08139, -0.10587, -0.03949;
    -0.04175, -0.04674, 0.25354, -0.00677, -0.03306, -0.05518;
    -0.02956, -0.08542, -0.00927, 0.28306, -0.10927, -0.02100;
    -0.04194, -0.08618, -0.02135, -0.09183, 0.33020, -0.00925;
    -0.04222, -0.03203, -0.03576, -0.03325, -0.00625, 0.23510
  )$
]

#v(2em)

==== Paper 2

#block[
  #set text(size: 14pt)
  #set math.mat(delim: "[", gap: 0.5em, row-gap: 0.6em)
  $(k*(1+b)*B_2/(1-a_1+a_2)) = mat(
    0.28160, -0.00520, -0.04060, -0.03050, -0.03160, -0.05050;
    -0.01110, 0.26590, -0.04230, -0.06660, -0.07560, -0.03460;
    -0.04700, -0.03320, 0.27950, -0.00640, -0.02370, -0.05300;
    -0.03080, -0.06460, -0.01290, 0.23480, -0.08330, -0.01930;
    -0.04110, -0.06610, -0.02170, -0.07600, 0.25370, -0.01180;
    -0.04770, -0.02080, -0.04020, -0.02500, -0.00560, 0.23020
  )$
]

#pagebreak()





#block[
  #set text(size: 17pt)
  #set math.mat(delim: "[", gap: 0.5em, row-gap: 0.6em)
  $B_1 = mat(
    10.3259, -0.2285, -1.3868, -1.5546, -1.8743, -1.9771;
    -0.2839, 13.7727, -1.6703, -3.2294, -4.2009, -1.5669;
    -1.6567, -1.8547, 10.0604, -0.2685, -1.3119, -2.1896;
    -1.1730, -3.3894, -0.3678, 11.2317, -4.3358, -0.8334;
    -1.6642, -3.4197, -0.8470, -3.6438, 13.1021, -0.3671;
    -1.6753, -1.2710, -1.4188, -1.3193, -0.2481,  9.3287
  ) times 10^(-4)$
]

#v(3em)

#block[
  #set text(size: 17pt)
  #set math.mat(delim: "[", gap: 0.5em, row-gap: 0.6em)
  $B_"1_new" =  mat(
     9.7842, -0.2510, -1.3334, -1.4655, -1.7369, -1.4912;
    -0.1518, 12.0541, -1.7569, -2.8577, -3.1082, -1.6435;
    -1.5395, -1.4060,  8.6906, -0.2320, -1.0449, -1.4971;
    -1.0785, -3.3851, -0.2351,  9.9014, -3.0887, -0.9820;
    -1.6440, -3.2121, -0.9450, -2.9831, 10.3059, -0.2027;
    -1.0224, -1.5902, -1.0580, -1.1658, -0.1142,  8.0375
  ) times 10^(-4)$
]

#pagebreak()


#block[
  #set text(size: 20pt)
  #set math.mat(delim: "[", gap: 0.4em, row-gap: 0.5em)
  $B^(-1) = 10^3 times mat(
    6.2595, 1.6437, 1.7745, 2.3024, 2.2428, 2.3368;
    2.3289, 7.9394, 2.4927, 4.3450, 4.3787, 2.8669;
    2.0437, 2.0007, 6.1656, 1.9470, 2.1199, 2.4405;
    2.7199, 4.0169, 2.2049, 9.3235, 4.8635, 2.7391;
    2.7140, 3.7993, 2.2161, 4.5731, 8.6991, 2.5060;
    2.2258, 1.9360, 1.9630, 2.3335, 1.9704, 7.5507
  )$
]

#pagebreak()


#v(1em)

#block[
  #set text(size: 18pt)
  #set math.mat(delim: "[", gap: 0.5em, row-gap: 0.6em)
  $"DC_MAT" = mat(
    0.4820, 0.0398, 0.0691, 0.1061, 0.0968, 0.0638;
    0.0572, 0.3142, 0.1288, 0.0722, 0.0565, 0.1342;
    0.0676, 0.0916, 0.4596, 0.0468, 0.0830, 0.0714;
    0.1267, 0.0607, 0.0568, 0.3803, 0.0597, 0.1233;
    0.1358, 0.0568, 0.1200, 0.0711, 0.3114, 0.0559;
    0.0630, 0.0955, 0.0709, 0.1025, 0.0378, 0.4648
  )$
]

#pagebreak()

=== Paper 1 B matrix 
#v(3em)
#block[
  #set text(size: 18pt)
  #set math.mat(delim: "[", gap: 0.5em, row-gap: 0.6em)
  $B = mat(
     10.3259, -0.2285, -1.3868, -1.5546, -1.8743, -1.9771;
    -0.2839, 13.7727, -1.6703, -3.2294, -4.2009, -1.5669;
    -1.6567, -1.8547, 10.0604, -0.2685, -1.3119, -2.1896;
    -1.1730, -3.3894, -0.3678, 11.2317, -4.3358, -0.8334;
    -1.6642, -3.4197, -0.8470, -3.6438, 13.1021, -0.3671;
    -1.6753, -1.2710, -1.4188, -1.3193, -0.2481,  9.3287
  ) times 10^(-4)$
]
